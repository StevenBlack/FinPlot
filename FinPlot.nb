(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[     48583,        938]
NotebookOptionsPosition[     47516,        910]
NotebookOutlinePosition[     47913,        926]
CellTagsIndexPosition[     47870,        923]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["FinPlot[]", "Title",
 CellChangeTimes->{{3.926023308569791*^9, 3.926023308571842*^9}, {
  3.9260233537315702`*^9, 3.9260233757347517`*^9}, {3.92602405662719*^9, 
  3.926024085440996*^9}, {3.926093332259821*^9, 3.926093346715509*^9}, {
  3.926103473564667*^9, 3.9261034746877203`*^9}, {3.92618590265519*^9, 
  3.9261859220416393`*^9}, {3.926453747162169*^9, 3.9264537490680323`*^9}, {
  3.952446904247444*^9, 3.952446910176691*^9}, {3.952456418105392*^9, 
  3.9524564239143667`*^9}, {3.952528057990715*^9, 3.9525280725813513`*^9}, {
  3.9546009195192213`*^9, 3.954600927099916*^9}, {3.95461905927255*^9, 
  3.954619061326182*^9}, {3.954704085750555*^9, 
  3.9547040893506947`*^9}},ExpressionUUID->"e80cee27-40fb-4de8-aadd-\
ab763ef324d7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\"\<Global`\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Buttons", " ", "to", " ", 
    RowBox[{"hide", "/", "show"}], " ", "code"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"CloseAllInputsCells", "[", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"nb", ",", "cells"}], "}"}], ",", 
      RowBox[{
       RowBox[{"nb", "=", 
        RowBox[{"EvaluationNotebook", "[", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"cells", "=", 
        RowBox[{"Cells", "[", 
         RowBox[{"nb", ",", 
          RowBox[{"CellStyle", "->", "\"\<Input\>\""}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"SetOptions", "[", 
          RowBox[{"#", ",", 
           RowBox[{"CellOpen", "->", "False"}]}], "]"}], "&"}], "/@", 
        "cells"}], ";"}]}], "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OpenAllInputsCells", "[", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"nb", ",", "cells"}], "}"}], ",", 
      RowBox[{
       RowBox[{"nb", "=", 
        RowBox[{"EvaluationNotebook", "[", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"cells", "=", 
        RowBox[{"Cells", "[", 
         RowBox[{"nb", ",", 
          RowBox[{"CellStyle", "->", "\"\<Input\>\""}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"SetOptions", "[", 
          RowBox[{"#", ",", 
           RowBox[{"CellOpen", "->", "True"}]}], "]"}], "&"}], "/@", 
        "cells"}], ";"}]}], "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Button", "[", 
     RowBox[{"\"\<Hide Code\>\"", ",", 
      RowBox[{"SelectionEvaluate", "[", 
       RowBox[{"CloseAllInputsCells", "[", "]"}], "]"}]}], "]"}], ",", 
    RowBox[{"Button", "[", 
     RowBox[{"\"\<Show Code\>\"", ",", 
      RowBox[{"SelectionEvaluate", "[", 
       RowBox[{"OpenAllInputsCells", "[", "]"}], "]"}]}], "]"}]}], "}"}], 
  "]"}]}], "Input",
 CellOpen->True,
 CellChangeTimes->{{3.926104252000985*^9, 3.926104281231701*^9}, {
   3.926104311812336*^9, 3.9261044510384693`*^9}, {3.926104553946717*^9, 
   3.926104561030199*^9}, {3.926104601427572*^9, 3.926104610490177*^9}, 
   3.926105810837723*^9, {3.926106155457353*^9, 3.926106306297263*^9}, {
   3.92610656037186*^9, 3.926106562958413*^9}, {3.926106610350261*^9, 
   3.926106611223668*^9}, {3.9261084592476873`*^9, 3.926108509236771*^9}, {
   3.9261086943617*^9, 3.926108699847063*^9}, {3.926109203547082*^9, 
   3.926109238867244*^9}, {3.926109364248454*^9, 3.926109393213396*^9}, {
   3.9261094871886797`*^9, 3.9261095184035873`*^9}, {3.926109562653056*^9, 
   3.926109623095701*^9}, {3.926109683374778*^9, 3.926109700379759*^9}, {
   3.926109859206336*^9, 3.92610986787817*^9}, {3.926188629151389*^9, 
   3.926188664161387*^9}, {3.926189309481555*^9, 3.926189404586179*^9}, 
   3.926189931586179*^9, {3.926190019739454*^9, 3.92619003491089*^9}, {
   3.926190091243922*^9, 3.926190229292127*^9}, {3.926191781303092*^9, 
   3.926191796682922*^9}, {3.926191835534973*^9, 3.926191863757341*^9}, {
   3.92619193303052*^9, 3.926191974564766*^9}, {3.926369800949707*^9, 
   3.92636980304499*^9}, {3.926370786337678*^9, 3.926370978976664*^9}, {
   3.926371074924803*^9, 3.926371156641964*^9}, {3.926371289785094*^9, 
   3.926371338695156*^9}, {3.926371382244561*^9, 3.926371389034145*^9}, {
   3.926371801551454*^9, 3.926371814186254*^9}, {3.92645401270918*^9, 
   3.926454022280169*^9}, {3.926454071519158*^9, 3.926454072726646*^9}, 
   3.926454289286805*^9, {3.926882636651235*^9, 3.926882659426392*^9}, {
   3.926888343654386*^9, 3.9268883638594227`*^9}, {3.952446728614685*^9, 
   3.9524467347124243`*^9}, {3.952446844018119*^9, 3.952446861600758*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"14006091-21fb-46e0-9a46-e1fcba7cf712"],

Cell[BoxData[
 TemplateBox[{
   ButtonBox["\"Hide Code\"", ButtonFunction :> SelectionEvaluate[
      $CellContext`CloseAllInputsCells[]], Appearance -> Automatic, Evaluator -> 
    Automatic, Method -> "Preemptive"], 
   ButtonBox["\"Show Code\"", ButtonFunction :> SelectionEvaluate[
      $CellContext`OpenAllInputsCells[]], Appearance -> Automatic, Evaluator -> 
    Automatic, Method -> "Preemptive"]},
  "RowDefault"]], "Output",
 CellChangeTimes->{
  3.952446867614901*^9, 3.9524564800847397`*^9, 3.9524568362247353`*^9, 
   3.952457555538231*^9, 3.952458109022983*^9, 3.9524603246406393`*^9, 
   3.952528051060986*^9, 3.9525280825104837`*^9, 3.952699842526999*^9, 
   3.9528861965189047`*^9, 3.953056379804614*^9, 3.953143950269197*^9, 
   3.9531448719777*^9, 3.953145040124102*^9, 3.953148027232687*^9, 
   3.953150676171822*^9, 3.953150897629825*^9, 3.953153538074904*^9, 
   3.953207481286684*^9, 3.953285102283392*^9, 3.953285163048512*^9, 
   3.953665619079117*^9, 3.953666366650427*^9, 3.953666420061447*^9, 
   3.953666466946628*^9, 3.953668126373784*^9, 3.953668194794071*^9, 
   3.953668409880533*^9, 3.9536684534432793`*^9, 3.953668491671989*^9, 
   3.95366855001157*^9, 3.953668693144581*^9, 3.953668929568327*^9, 
   3.953668986252283*^9, 3.9536690240571527`*^9, 3.953669506960058*^9, 
   3.953669563452402*^9, {3.953670091297291*^9, 3.9536701140654507`*^9}, 
   3.953670278136483*^9, 3.953670390861226*^9, 3.9536704262167377`*^9, 
   3.953670608087501*^9, 3.953729742723693*^9, 3.9537411967845583`*^9, 
   3.9542633501847153`*^9, 3.9542729686256113`*^9, 3.954334880397641*^9, 
   3.9543350823557863`*^9, 3.954335209360549*^9, 3.954335681666689*^9, 
   3.9544343619148903`*^9, 3.9546007008040247`*^9, 3.954600973731683*^9, 
   3.954602728670959*^9, 3.954604835356583*^9, 3.954604909707861*^9, 
   3.954604947723937*^9, 3.9546059485811853`*^9, 3.9546964036217403`*^9, 
   3.954704100409814*^9, 3.9547044728501463`*^9, 3.954710158633637*^9, 
   3.954762597256743*^9, 3.954778971142612*^9, 3.9547824569700823`*^9, 
   3.95496827485421*^9, 3.955202502355669*^9, 3.955208132032625*^9, 
   3.9552900703865433`*^9},
 CellLabel->"Out[5]=",ExpressionUUID->"f864cdac-2071-423a-911d-c55c75b2c339"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"FinPlot", "[", 
      RowBox[{"ts_", ",", "lbl_", ",", 
       RowBox[{"options_", ":", 
        RowBox[{"<|", "|>"}]}]}], "]"}], ":=", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tslist", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{
            RowBox[{"Head", "[", "ts", "]"}], ",", "List"}], "]"}], ",", "ts",
           ",", 
          RowBox[{"List", "[", "ts", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"defaults", "=", 
        RowBox[{"<|", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"aspectratio", "->", 
           RowBox[{"1", "/", "3"}]}], "\[IndentingNewLine]", ",", 
          RowBox[{"colorscheme", "->", " ", "97"}], "\[IndentingNewLine]", ",", 
          RowBox[{"export", "->", "False"}], "\[IndentingNewLine]", ",", 
          RowBox[{"filling", " ", "->", " ", "None"}], "\[IndentingNewLine]", 
          ",", 
          RowBox[{"fillingstyle", " ", "->", " ", "Automatic"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"framemargins", "->", "None"}], "\[IndentingNewLine]", ",", 
          
          RowBox[{"gridlinesx", "->", "Automatic"}], "\[IndentingNewLine]", ",", 
          RowBox[{"gridlinesy", "->", "Automatic"}], "\[IndentingNewLine]", ",", 
          RowBox[{"imagemargins", "->", "20"}], "\[IndentingNewLine]", ",", 
          RowBox[{"imagesize", "->", "1000"}], "\[IndentingNewLine]", ",", 
          RowBox[{"joined", "->", "True"}], "\[IndentingNewLine]", ",", 
          RowBox[{"labelstyle", "->", 
           RowBox[{"{", "14", "}"}]}], "\[IndentingNewLine]", ",", 
          RowBox[{"normalize", "->", "False"}], "\[IndentingNewLine]", ",", 
          RowBox[{"origindate", "->", "\"\<Sep. 14, 2011\>\""}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"background", "->", "White"}], "\[IndentingNewLine]", ",", 
          RowBox[{"plotfunction", "->", "DateListPlot"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"plotfunctions", "->", 
           RowBox[{"{", "}"}]}], " ", 
          RowBox[{"(*", " ", "future", " ", "*)"}], "\[IndentingNewLine]", ",", 
          RowBox[{"plotrange", "->", "Full"}], "\[IndentingNewLine]", ",", 
          RowBox[{"rangestyle", "->", 
           RowBox[{"{", "20", "}"}]}], "\[IndentingNewLine]", ",", 
          RowBox[{"subtitlestyle", "->", 
           RowBox[{"{", "15", "}"}]}], "\[IndentingNewLine]", ",", 
          RowBox[{"summarystyle", "->", 
           RowBox[{"{", "20", "}"}]}], "\[IndentingNewLine]", ",", 
          RowBox[{"ticksstyle", "->", 
           RowBox[{"{", "16", "}"}]}], "\[IndentingNewLine]", ",", 
          RowBox[{"titlestyle", "->", 
           RowBox[{"{", 
            RowBox[{"20", ",", "Blue"}], "}"}]}], "\[IndentingNewLine]", ",", 
          
          RowBox[{"monthsinitial", "->", "144"}]}], "\[IndentingNewLine]", 
         "|>"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"settings", " ", "=", " ", 
        RowBox[{"Merge", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"defaults", ",", "options"}], "}"}], ",", "Last"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"monthslist", "=", 
        RowBox[{"Reverse", "[", "\[IndentingNewLine]", 
         RowBox[{"Join", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "3", ",", " ", "6", ",", " ", "9"}], 
            "}"}], "\[IndentingNewLine]", ",", 
           RowBox[{"Range", "[", 
            RowBox[{"12", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"DateDifference", "[", 
                RowBox[{
                 RowBox[{"settings", "[", "origindate", "]"}], ",", "Now", 
                 ",", "\"\<Month\>\""}], "]"}], "//", "IntegerPart"}], "//", 
              "QuantityMagnitude"}], ",", "6"}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"plot", "=", 
        RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "tsx", ",", " ", "tsxunnormalized", ",", "filename", ",", " ", 
              "plot", ",", " ", "updatedstr"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"updatedstr", "=", 
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                 "StringTemplate", "[", "\"\<(updated: ``)\>\"", "]"}], "[", 
                 RowBox[{"DateString", "[", "]"}], "]"}], ",", 
                RowBox[{"settings", "[", "subtitlestyle", "]"}]}], "]"}]}], ";",
              "\[IndentingNewLine]", 
             RowBox[{"tsxunnormalized", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"TimeSeriesWindow", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Today", "-", 
                    RowBox[{"Quantity", "[", 
                    RowBox[{"x", ",", "\"\<Months\>\""}], "]"}]}], ",", 
                    "Today"}], "}"}]}], "]"}], "&"}], "/@", "tslist"}]}], ";",
              "\[IndentingNewLine]", 
             RowBox[{"tsx", "=", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"settings", "[", "normalize", "]"}], 
                "\[IndentingNewLine]", ",", 
                RowBox[{
                 RowBox[{
                  FractionBox[
                   RowBox[{"#", " ", "*", " ", "100"}], 
                   RowBox[{"#", "[", "\"\<FirstValue\>\"", "]"}]], "&"}], "/@",
                  "tsxunnormalized"}], "\[IndentingNewLine]", ",", 
                "tsxunnormalized"}], "\[IndentingNewLine]", "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Column", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Column", "[", "\[IndentingNewLine]", 
                  RowBox[{"MapIndexed", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Style", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Style", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"ToString", "[", "\[IndentingNewLine]", 
                    RowBox[{"PercentForm", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    FractionBox[
                    RowBox[{
                    RowBox[{"#", "[", "\"\<LastValue\>\"", "]"}], "-", 
                    RowBox[{"#", "[", "\"\<FirstValue\>\"", "]"}]}], 
                    RowBox[{"#", "[", "\"\<FirstValue\>\"", "]"}]], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{"NumberSeparator", "->", "\"\<,\>\""}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{"DigitBlock", "->", "3"}]}], 
                    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
                    "]"}], "\[IndentingNewLine]", ",", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", " ", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "\"\<LastValue\>\"", "]"}], ">", 
                    RowBox[{"#", "[", "\"\<FirstValue\>\"", "]"}]}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{"Darker", "[", "Green", "]"}], 
                    "\[IndentingNewLine]", ",", "Red"}], 
                    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
                    "Bold"}], "\[IndentingNewLine]", "}"}]}], 
                    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
                    
                    RowBox[{"\"\<Latest: \>\"", " ", "<>", " ", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"#", "[", "\"\<LastValue\>\"", "]"}], "]"}]}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{"\"\<ATH: \>\"", " ", "<>", " ", 
                    RowBox[{"ToString", "[", 
                    RowBox[{
                    RowBox[{"Max", "[", "#", "]"}], "//", 
                    "QuantityMagnitude"}], "]"}]}]}], "\[IndentingNewLine]", 
                    "}"}], "\[IndentingNewLine]", ",", 
                    RowBox[{"Spacer", "[", "20", "]"}]}], 
                    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
                    
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"settings", "[", "summarystyle", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ColorData", "[", 
                    RowBox[{
                    RowBox[{"settings", "[", "colorscheme", "]"}], 
                    ",", "\"\<ColorList\>\""}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"First", "[", "#2", "]"}], "]"}], "]"}], "}"}]}], 
                    "]"}]}], "\[IndentingNewLine]", "]"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{"Spacer", "[", "60", "]"}], "\[IndentingNewLine]",
                     ",", 
                    RowBox[{"Style", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Row", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"\"\<Min: \>\"", " ", "<>", " ", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"#", "//", "Min"}], "]"}]}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{"\"\<Mean: \>\"", " ", "<>", " ", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"#", "//", "Mean"}], "]"}]}], " ", 
                    "\[IndentingNewLine]", ",", " ", 
                    RowBox[{"\"\<Max: \>\"", " ", "<>", " ", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"#", "//", "Max"}], "]"}]}]}], 
                    "\[IndentingNewLine]", "}"}], ",", 
                    RowBox[{"Spacer", "[", "20", "]"}]}], "]"}], ",", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"settings", "[", "rangestyle", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ColorData", "[", 
                    RowBox[{
                    RowBox[{"settings", "[", "colorscheme", "]"}], 
                    ",", "\"\<ColorList\>\""}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"First", "[", "#2", "]"}], "]"}], "]"}], "}"}]}], 
                    "]"}]}], "\[IndentingNewLine]", "]"}]}], 
                    "\[IndentingNewLine]", "}"}], "]"}], "&"}], 
                    "\[IndentingNewLine]", ",", "tsx"}], 
                   "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"settings", "[", "plotfunction", "]"}], "[", 
                  "\[IndentingNewLine]", 
                  RowBox[{"tsx", "\[IndentingNewLine]", ",", 
                   RowBox[{"AspectRatio", "\[Rule]", 
                    RowBox[{"settings", "[", "aspectratio", "]"}]}], 
                   "\[IndentingNewLine]", ",", 
                   RowBox[{"Background", "->", 
                    RowBox[{"settings", "[", "background", "]"}]}], 
                   "\[IndentingNewLine]", ",", 
                   RowBox[{"ImageMargins", "->", 
                    RowBox[{"settings", "[", "imagemargins", "]"}]}], 
                   "\[IndentingNewLine]", ",", 
                   RowBox[{"ImageSize", "->", " ", 
                    RowBox[{"settings", "[", "imagesize", "]"}]}], 
                   "\[IndentingNewLine]", ",", 
                   RowBox[{"Filling", "\[Rule]", 
                    RowBox[{"settings", "[", "filling", "]"}]}], 
                   "\[IndentingNewLine]", ",", 
                   RowBox[{"FillingStyle", "\[Rule]", 
                    RowBox[{"settings", "[", "fillingstyle", "]"}]}], 
                   "\[IndentingNewLine]", ",", 
                   RowBox[{"FrameTicksStyle", "\[Rule]", 
                    RowBox[{"settings", "[", "ticksstyle", "]"}]}], 
                   "\[IndentingNewLine]", ",", 
                   RowBox[{"FrameTicks", "->", "All"}], "\[IndentingNewLine]",
                    ",", 
                   RowBox[{"GridLines", "->", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"settings", "[", "gridlinesx", "]"}], ",", 
                    RowBox[{"settings", "[", "gridlinesy", "]"}]}], "}"}]}], 
                   "\[IndentingNewLine]", ",", 
                   RowBox[{"Joined", "->", " ", 
                    RowBox[{"settings", "[", "joined", "]"}]}], 
                   "\[IndentingNewLine]", ",", 
                   RowBox[{"LabelStyle", "->", 
                    RowBox[{"settings", "[", "labelstyle", "]"}]}], 
                   "\[IndentingNewLine]", ",", 
                   RowBox[{"PlotLabel", "->", 
                    RowBox[{"Column", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"lbl", ",", 
                    RowBox[{"settings", "[", "titlestyle", "]"}]}], "]"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ToString", "[", "x", "]"}], " ", "<>", 
                    " ", "\"\< months\>\""}], ",", 
                    RowBox[{"settings", "[", "titlestyle", "]"}]}], "]"}], 
                    "\[IndentingNewLine]", ",", "updatedstr"}], 
                    "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", ",", 
                    "Center"}], "\[IndentingNewLine]", "]"}]}], 
                   "\[IndentingNewLine]", ",", 
                   RowBox[{"PlotRange", "->", 
                    RowBox[{"settings", "[", "plotrange", "]"}]}], 
                   "\[IndentingNewLine]", ",", 
                   RowBox[{"PlotStyle", "->", 
                    RowBox[{"ColorData", "[", 
                    RowBox[{"settings", "[", "colorscheme", "]"}], "]"}]}]}], 
                  "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
                "}"}], "\[IndentingNewLine]", ",", 
               RowBox[{"Background", "->", 
                RowBox[{"settings", "[", "background", "]"}]}]}], 
              "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
          "\[IndentingNewLine]", ",", " ", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", "\[IndentingNewLine]", ",", 
              RowBox[{"settings", "[", "monthsinitial", "]"}], 
              "\[IndentingNewLine]", ",", "\"\<Months: \>\""}], 
             "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", ",", " ", 
            "monthslist"}], "\[IndentingNewLine]", "}"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"LabelStyle", "->", 
           RowBox[{"settings", "[", "labelstyle", "]"}]}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"FrameMargins", "->", 
           RowBox[{"settings", "[", "framemargins", "]"}]}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"settings", "[", "export", "]"}], "\[IndentingNewLine]", ",", 
         RowBox[{
          RowBox[{"Export", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
             RowBox[{"StringReplace", "[", 
              RowBox[{"lbl", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\"\< \>\"", "->", "\"\<-\>\""}], ",", 
                 RowBox[{"\"\<(\>\"", "->", "\"\<\>\""}], ",", 
                 RowBox[{"\"\<)\>\"", "->", "\"\<\>\""}]}], "}"}]}], "]"}], 
             "<>", "\"\<.jpg\>\""}], "\[IndentingNewLine]", ",", "plot"}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"finally", " ", "emit", " ", "the", " ", "plot"}], " ", 
        "*)"}], "\[IndentingNewLine]", "plot"}], "\[IndentingNewLine]", 
      ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"intermediate", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"UnitConvert", "[", 
           RowBox[{
            RowBox[{"Today", "-", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", "\"\<Years\>\""}], "]"}],
           ",", 
          RowBox[{"1", "+", 
           FractionBox[
            RowBox[{"price", " ", "-", " ", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]]}]}], "}"}], "&"}], "/@", 
       RowBox[{"Normal", "[", "btcxau", "]"}]}]}], ";", "\n", 
     RowBox[{"roi", "=", 
      RowBox[{"Dataset", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "4", "]"}], "]"}], "^", 
              RowBox[{"(", 
               RowBox[{"1", "/", 
                RowBox[{"QuantityMagnitude", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "]"}]}], ")"}]}], ")"}], "-",
             "1"}]}], "}"}], "&"}], "/@", " ", 
        RowBox[{"Drop", "[", 
         RowBox[{"intermediate", ",", 
          RowBox[{"-", "1"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"btcxauroi", " ", "=", " ", 
      RowBox[{"Drop", "[", 
       RowBox[{"roi", ",", 
        RowBox[{"-", "180"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"btcxauroiplot", "=", 
      RowBox[{"display", "[", 
       RowBox[{"btcxauroi", ",", "\"\<BTC-XAU ROI\>\""}], "]"}]}], ";"}], 
    "*)"}], "\[IndentingNewLine]"}]}]], "Input",
 CellOpen->True,
 CellChangeTimes->{{3.926104252000985*^9, 3.926104281231701*^9}, {
   3.926104311812336*^9, 3.9261044510384693`*^9}, {3.926104553946717*^9, 
   3.926104561030199*^9}, {3.926104601427572*^9, 3.926104610490177*^9}, 
   3.926105810837723*^9, {3.926106155457353*^9, 3.926106306297263*^9}, {
   3.92610656037186*^9, 3.926106562958413*^9}, {3.926106610350261*^9, 
   3.926106611223668*^9}, {3.9261084592476873`*^9, 3.926108509236771*^9}, {
   3.9261086943617*^9, 3.926108699847063*^9}, {3.926109203547082*^9, 
   3.926109238867244*^9}, {3.926109364248454*^9, 3.926109393213396*^9}, {
   3.9261094871886797`*^9, 3.9261095184035873`*^9}, {3.926109562653056*^9, 
   3.926109623095701*^9}, {3.926109683374778*^9, 3.926109700379759*^9}, {
   3.926109859206336*^9, 3.92610986787817*^9}, {3.926188629151389*^9, 
   3.926188664161387*^9}, {3.926189309481555*^9, 3.926189404586179*^9}, 
   3.926189931586179*^9, {3.926190019739454*^9, 3.92619003491089*^9}, {
   3.926190091243922*^9, 3.926190229292127*^9}, {3.926191781303092*^9, 
   3.926191796682922*^9}, {3.926191835534973*^9, 3.926191863757341*^9}, {
   3.92619193303052*^9, 3.926191974564766*^9}, {3.926369800949707*^9, 
   3.92636980304499*^9}, {3.926370786337678*^9, 3.926370978976664*^9}, {
   3.926371074924803*^9, 3.926371156641964*^9}, {3.926371289785094*^9, 
   3.926371338695156*^9}, {3.926371382244561*^9, 3.926371389034145*^9}, {
   3.926371801551454*^9, 3.926371814186254*^9}, {3.92645401270918*^9, 
   3.926454022280169*^9}, {3.926454071519158*^9, 3.926454072726646*^9}, 
   3.926454289286805*^9, {3.926882636651235*^9, 3.926882659426392*^9}, {
   3.926888343654386*^9, 3.9268883638594227`*^9}, {3.952446728614685*^9, 
   3.9524467347124243`*^9}, {3.952446844018119*^9, 3.952446861600758*^9}, {
   3.952446926953251*^9, 3.9524469860592957`*^9}, {3.952447059504593*^9, 
   3.95244706882583*^9}, {3.952447108277382*^9, 3.9524471151653357`*^9}, {
   3.952447258781312*^9, 3.952447259750098*^9}, {3.952447312432241*^9, 
   3.952447357444745*^9}, {3.952447546766831*^9, 3.95244760214671*^9}, {
   3.952447795726618*^9, 3.952447796144129*^9}, {3.952447872956262*^9, 
   3.952447874486718*^9}, {3.952447912510089*^9, 3.952447924492119*^9}, {
   3.952447966138659*^9, 3.9524480237835903`*^9}, {3.952448061515235*^9, 
   3.952448078267148*^9}, {3.9524566086854963`*^9, 3.952456630953299*^9}, {
   3.952456675791904*^9, 3.9524567012063923`*^9}, {3.952456732295424*^9, 
   3.9524567678523693`*^9}, 3.9524568028050013`*^9, {3.952456967798615*^9, 
   3.9524569702543907`*^9}, {3.952457099140026*^9, 3.95245712252528*^9}, {
   3.952457165791066*^9, 3.952457266623212*^9}, {3.952457327003092*^9, 
   3.952457428186534*^9}, {3.952457473615986*^9, 3.95245752103961*^9}, {
   3.9524580849650717`*^9, 3.952458091486883*^9}, {3.952458146840315*^9, 
   3.952458164217518*^9}, {3.9524584969435673`*^9, 3.952458502156067*^9}, {
   3.952459757675508*^9, 3.95245988543277*^9}, {3.95246015727767*^9, 
   3.952460163712906*^9}, {3.952460210946205*^9, 3.952460222265772*^9}, 
   3.952460275090103*^9, {3.9527000563016443`*^9, 3.952700129745454*^9}, 
   3.952700167160305*^9, {3.952888497351879*^9, 3.9528885263235493`*^9}, {
   3.9528888205626993`*^9, 3.952888828843718*^9}, {3.952888968063587*^9, 
   3.9528889944782124`*^9}, {3.952889031427175*^9, 3.952889081153842*^9}, {
   3.952889120063002*^9, 3.9528891545088453`*^9}, {3.952889196436792*^9, 
   3.952889268017848*^9}, {3.9528893231978188`*^9, 3.952889329086198*^9}, {
   3.952889473227623*^9, 3.952889489077791*^9}, {3.952889558918879*^9, 
   3.9528895817255096`*^9}, {3.952889626981695*^9, 3.952889748709886*^9}, {
   3.952889790582436*^9, 3.952889862337656*^9}, {3.953144086981701*^9, 
   3.95314409194276*^9}, {3.953144143349642*^9, 3.9531441553831997`*^9}, {
   3.953144296275422*^9, 3.953144622583562*^9}, {3.95314470570119*^9, 
   3.9531447594044456`*^9}, {3.953144827888645*^9, 3.953144861824959*^9}, 
   3.953145110516129*^9, 3.953145147803143*^9, 3.95314951745627*^9, {
   3.953149609693894*^9, 3.953149616272319*^9}, {3.9531499142393017`*^9, 
   3.953149984302759*^9}, {3.953150065213229*^9, 3.95315007777754*^9}, {
   3.9531539233570423`*^9, 3.9531539286196012`*^9}, {3.953207426595636*^9, 
   3.953207472852116*^9}, {3.9532851515561743`*^9, 3.953285153636491*^9}, {
   3.95366631237228*^9, 3.953666348467657*^9}, {3.9536664072261763`*^9, 
   3.95366645590489*^9}, {3.953667974150857*^9, 3.953668046138537*^9}, {
   3.953668083443245*^9, 3.9536681153620462`*^9}, {3.9536681892197733`*^9, 
   3.953668191038905*^9}, {3.953668380592616*^9, 3.953668403319241*^9}, {
   3.95366844393438*^9, 3.95366846844452*^9}, {3.953668509823403*^9, 
   3.953668534146096*^9}, {3.953668677288554*^9, 3.953668687688534*^9}, 
   3.953668736374968*^9, {3.9536688428111973`*^9, 3.95366892089808*^9}, {
   3.953668955718031*^9, 3.953668968136257*^9}, 3.953669007345511*^9, {
   3.953669324948183*^9, 3.953669339929853*^9}, {3.953669424407102*^9, 
   3.953669500558165*^9}, {3.953669546416691*^9, 3.953669558343807*^9}, {
   3.953670040405519*^9, 3.9536701053487167`*^9}, {3.953670270533207*^9, 
   3.95367027287297*^9}, {3.9536704175714397`*^9, 3.9536704198658447`*^9}, {
   3.9537409432112837`*^9, 3.953740958502689*^9}, {3.953741164904656*^9, 
   3.9537411866911297`*^9}, {3.954335053730435*^9, 3.95433507210441*^9}, {
   3.95433513387385*^9, 3.954335170434587*^9}, {3.954335662017109*^9, 
   3.954335675862197*^9}, {3.95460095786502*^9, 3.954600969404681*^9}, {
   3.954601063430311*^9, 3.954601097916287*^9}, {3.95460113931676*^9, 
   3.954601156019414*^9}, {3.9546015305816803`*^9, 3.954601532590725*^9}, {
   3.954601868882473*^9, 3.954601875930675*^9}, {3.954602344419361*^9, 
   3.954602497545981*^9}, {3.954602568392466*^9, 3.954602622743574*^9}, {
   3.9546026742329617`*^9, 3.9546027056917467`*^9}, {3.954602747707621*^9, 
   3.954602763686471*^9}, {3.954602801431076*^9, 3.954602883742153*^9}, {
   3.95460314405615*^9, 3.9546032097534037`*^9}, {3.9546035860018873`*^9, 
   3.954603708709303*^9}, {3.954603763975938*^9, 3.954603809516083*^9}, {
   3.954603853862892*^9, 3.9546038677409782`*^9}, {3.954604195441119*^9, 
   3.9546042056076937`*^9}, {3.954604751363966*^9, 3.954604782257044*^9}, {
   3.9546048211222267`*^9, 3.9546048950516167`*^9}, {3.954604938962454*^9, 
   3.9546049417671013`*^9}, {3.954605270940467*^9, 3.954605289302606*^9}, {
   3.954696299559781*^9, 3.9546963141942987`*^9}, 3.954696365653648*^9, {
   3.9546964517845*^9, 3.954696471391265*^9}, {3.954704452270462*^9, 
   3.954704465289089*^9}, {3.9547047646420517`*^9, 3.954704824391959*^9}, {
   3.954704945223339*^9, 3.954704959456685*^9}, {3.95470552122438*^9, 
   3.9547055217286253`*^9}, {3.954706024623846*^9, 3.954706065902906*^9}, {
   3.954706258876361*^9, 3.954706328955934*^9}, {3.95470666040891*^9, 
   3.9547066937417107`*^9}, {3.954706728316283*^9, 3.954706739228066*^9}, {
   3.9547067700726643`*^9, 3.9547068303093443`*^9}, {3.954706875640759*^9, 
   3.954706883725567*^9}, {3.954707308171604*^9, 3.954707347189931*^9}, {
   3.954707440469878*^9, 3.9547074948446074`*^9}, {3.954707981433477*^9, 
   3.9547080105985537`*^9}, {3.954708049028021*^9, 3.9547080496148987`*^9}, {
   3.954708097149988*^9, 3.954708098534481*^9}, {3.954708132161367*^9, 
   3.954708440904662*^9}, {3.954708476654125*^9, 3.954708516692902*^9}, {
   3.9547085481660357`*^9, 3.954708628984314*^9}, {3.954709190690427*^9, 
   3.954709191091185*^9}, {3.954709228754545*^9, 3.954709352491824*^9}, {
   3.954709396306522*^9, 3.954709414824615*^9}, 3.954709665538704*^9, {
   3.9547097565895452`*^9, 3.954709769591216*^9}, 3.954709941993471*^9, {
   3.954710020593363*^9, 3.9547100464432697`*^9}, {3.954762719231263*^9, 
   3.954762780552224*^9}, {3.9547630301421537`*^9, 3.9547630412786903`*^9}, {
   3.954763167520502*^9, 3.954763168220624*^9}, {3.9547632345690327`*^9, 
   3.954763270097578*^9}, {3.95476331654491*^9, 3.954763318590516*^9}, {
   3.954763593963204*^9, 3.9547635995506153`*^9}, {3.954763638628916*^9, 
   3.9547636953678703`*^9}, {3.9547789340584393`*^9, 3.954779005480721*^9}, {
   3.954782482733335*^9, 3.954782524199308*^9}, {3.954782567546055*^9, 
   3.9547825696718597`*^9}, {3.9547826763001757`*^9, 3.954782724675152*^9}, {
   3.954782810422492*^9, 3.954782912133868*^9}, {3.954782954885399*^9, 
   3.95478295526667*^9}, {3.954783042060872*^9, 3.9547830424762287`*^9}, {
   3.9552020555202293`*^9, 3.955202064755001*^9}, {3.955202112017261*^9, 
   3.955202174824091*^9}, {3.95520222080367*^9, 3.955202233560184*^9}, {
   3.955202311616496*^9, 3.955202386765121*^9}, {3.9552029026162033`*^9, 
   3.955202903144122*^9}, {3.955202972036827*^9, 3.955202995200267*^9}, {
   3.955203143973584*^9, 3.955203155120006*^9}, {3.955203676976521*^9, 
   3.955203684399149*^9}, 3.9552039323100986`*^9, {3.955204025912105*^9, 
   3.955204033289852*^9}, {3.9552041860882463`*^9, 3.955204241146805*^9}, {
   3.955204294722538*^9, 3.955204417726736*^9}, {3.9552044992789297`*^9, 
   3.955204528191077*^9}, 3.9552046064813557`*^9, {3.9552051113083973`*^9, 
   3.9552051950304537`*^9}, {3.955205424736731*^9, 3.955205509232773*^9}, {
   3.95520554669764*^9, 3.955205552523492*^9}, {3.955205596061429*^9, 
   3.9552056062089*^9}, {3.9552057951768303`*^9, 3.955205807809185*^9}, {
   3.955205846467329*^9, 3.955205850694271*^9}, {3.955205901489991*^9, 
   3.955205955521656*^9}, {3.955206057021138*^9, 3.95520606203804*^9}, 
   3.9552068133255243`*^9, {3.95520694073114*^9, 3.955206979465087*^9}, {
   3.955207031071617*^9, 3.955207032126542*^9}, {3.955207069590745*^9, 
   3.95520707043239*^9}, {3.9552072019577436`*^9, 3.955207209485394*^9}, {
   3.955207320117219*^9, 3.955207345004821*^9}, {3.955207395088773*^9, 
   3.9552074011624327`*^9}, {3.9552074549162483`*^9, 
   3.9552074571001883`*^9}, {3.9552075225420637`*^9, 3.955207531833256*^9}, {
   3.955282027439416*^9, 3.955282049053577*^9}, {3.955282181486631*^9, 
   3.9552822902674713`*^9}, {3.955282356017571*^9, 3.955282361936289*^9}, {
   3.955282662971945*^9, 3.955282682419648*^9}, {3.955282763814406*^9, 
   3.955282772084628*^9}, {3.955282816471015*^9, 3.955282930694977*^9}, {
   3.955290096057024*^9, 3.955290142078095*^9}, {3.955290473601672*^9, 
   3.955290479676708*^9}, {3.9552906233171167`*^9, 3.9552906278949413`*^9}, {
   3.955290680423414*^9, 3.955290721374338*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"33df2f7b-054e-4fe7-8633-eec369172053"],

Cell[BoxData[
 RowBox[{
  RowBox[{"xauusd", " ", "=", 
   RowBox[{"FinancialData", "[", 
    RowBox[{"\"\<XAU/USD\>\"", ",", 
     RowBox[{"{", 
      RowBox[{"1960", "-", "01", "-", "01"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.955203026348585*^9, 3.9552030287437077`*^9}, {
   3.955203173624309*^9, 3.955203175827855*^9}, {3.955203707403327*^9, 
   3.955203727764082*^9}, {3.955203781263632*^9, 3.95520382868286*^9}, 
   3.955203861411422*^9, {3.955204624666848*^9, 3.955204631675337*^9}, {
   3.955204681178471*^9, 3.955204685945712*^9}, 3.9552050776449337`*^9, {
   3.9552061195683823`*^9, 3.955206122289248*^9}, {3.955207559246621*^9, 
   3.95520756179825*^9}, {3.955207598295195*^9, 3.955207649347623*^9}, {
   3.955208153216605*^9, 3.9552082109189873`*^9}, {3.955208316205646*^9, 
   3.955208319817759*^9}, {3.955283106900882*^9, 3.955283165637203*^9}, {
   3.955283206432468*^9, 3.955283255551005*^9}, {3.955290159162964*^9, 
   3.955290205800906*^9}},ExpressionUUID->"5611880f-1d46-4cca-99fc-\
a76f374007cb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"xauusdplot", "=", 
   RowBox[{"FinPlot", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"xauusd", ",", " ", 
       RowBox[{"xauusd", "-", "150"}]}], "}"}], "\[IndentingNewLine]", 
     ",", "\"\<Gold price (USD)\>\"", "\[IndentingNewLine]", ",", 
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"imagesize", "->", "1000"}], "\[IndentingNewLine]", ",", 
       RowBox[{"joined", "->", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}]}], "\[IndentingNewLine]", ",", 
       
       RowBox[{"normalize", "->", "False"}]}], "\[IndentingNewLine]", 
      "|>"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.955203026348585*^9, 3.9552030287437077`*^9}, {
   3.955203173624309*^9, 3.955203175827855*^9}, {3.955203707403327*^9, 
   3.955203727764082*^9}, {3.955203781263632*^9, 3.95520382868286*^9}, 
   3.955203861411422*^9, {3.955204624666848*^9, 3.955204631675337*^9}, {
   3.955204681178471*^9, 3.955204685945712*^9}, 3.9552050776449337`*^9, {
   3.9552061195683823`*^9, 3.955206122289248*^9}, {3.955207559246621*^9, 
   3.95520756179825*^9}, {3.955207598295195*^9, 3.955207649347623*^9}, {
   3.955208153216605*^9, 3.9552082109189873`*^9}, {3.955208316205646*^9, 
   3.955208319817759*^9}, {3.955283106900882*^9, 3.955283165637203*^9}, {
   3.955283206432468*^9, 3.955283255551005*^9}, {3.955290159162964*^9, 
   3.955290245358738*^9}, {3.955290355001766*^9, 3.955290355641828*^9}, {
   3.955290557465721*^9, 3.955290567139853*^9}, {3.9552906648913603`*^9, 
   3.955290673656806*^9}, {3.955290738538291*^9, 3.955290764087569*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"5e768672-063a-4ac3-b17f-cd5d07b7240d"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`x$$ = 24, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`x$$], 144, "Months: "}, {162, 156, 150, 144, 138, 
      132, 126, 120, 114, 108, 102, 96, 90, 84, 78, 72, 66, 60, 54, 48, 42, 
      36, 30, 24, 18, 12, 9, 6, 3, 2, 1}, ControlType -> PopupMenu}}, 
    Typeset`size$$ = {1040., {246.4059680989582, 252.1379016927082}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = True, 
    Typeset`keyframeActionsQ$$ = False, Typeset`keyframeList$$ = {}}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`x$$ = 144}, 
      "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$, Typeset`keyframeActionsQ$$, 
        Typeset`keyframeList$$}, "Body" :> 
      Module[{$CellContext`tsx$, $CellContext`tsxunnormalized$, \
$CellContext`filename$, $CellContext`plot$, $CellContext`updatedstr$}, \
$CellContext`updatedstr$ = Style[
           StringTemplate["(updated: ``)"][
            DateString[]], 
           $CellContext`settings[$CellContext`subtitlestyle]]; \
$CellContext`tsxunnormalized$ = 
         Map[TimeSeriesWindow[#, {
            Today - Quantity[$CellContext`x$$, "Months"], 
             Today}]& , $CellContext`tslist]; $CellContext`tsx$ = If[
           $CellContext`settings[$CellContext`normalize], 
           
           Map[# 100/#[
            "FirstValue"]& , $CellContext`tsxunnormalized$], \
$CellContext`tsxunnormalized$]; Column[{
           Column[
            MapIndexed[Row[{
               Style[
                Row[{
                  Style[
                   ToString[
                    
                    PercentForm[(#["LastValue"] - #["FirstValue"])/#[
                    "FirstValue"], NumberSeparator -> ",", DigitBlock -> 3]], {
                    If[#["LastValue"] > #["FirstValue"], 
                    Darker[Green], Red], Bold}], "Latest: " <> ToString[
                    #["LastValue"]], "ATH: " <> ToString[
                    QuantityMagnitude[
                    Max[#]]]}, 
                 Spacer[20]], 
                Join[
                 $CellContext`settings[$CellContext`summarystyle], {
                  Part[
                   ColorData[
                    $CellContext`settings[$CellContext`colorscheme], 
                    "ColorList"], 
                   First[#2]]}]], 
               Spacer[60], 
               Style[
                Row[{"Min: " <> ToString[
                    Min[#]], "Mean: " <> ToString[
                    Mean[#]], "Max: " <> ToString[
                    Max[#]]}, 
                 Spacer[20]], 
                Join[
                 $CellContext`settings[$CellContext`rangestyle], {
                  Part[
                   ColorData[
                    $CellContext`settings[$CellContext`colorscheme], 
                    "ColorList"], 
                   First[#2]]}]]}]& , $CellContext`tsx$]], 
           $CellContext`settings[$CellContext`plotfunction][$CellContext`tsx$,
             AspectRatio -> $CellContext`settings[$CellContext`aspectratio], 
            Background -> $CellContext`settings[$CellContext`background], 
            ImageMargins -> $CellContext`settings[$CellContext`imagemargins], 
            ImageSize -> $CellContext`settings[$CellContext`imagesize], 
            Filling -> $CellContext`settings[$CellContext`filling], 
            FillingStyle -> $CellContext`settings[$CellContext`fillingstyle], 
            FrameTicksStyle -> $CellContext`settings[$CellContext`ticksstyle],
             FrameTicks -> All, GridLines -> {
              $CellContext`settings[$CellContext`gridlinesx], 
              $CellContext`settings[$CellContext`gridlinesy]}, 
            Joined -> $CellContext`settings[$CellContext`joined], 
            LabelStyle -> $CellContext`settings[$CellContext`labelstyle], 
            PlotLabel -> Column[{
               Style["Gold price (USD)", 
                $CellContext`settings[$CellContext`titlestyle]], 
               Style[ToString[$CellContext`x$$] <> " months", 
                $CellContext`settings[$CellContext`titlestyle]], \
$CellContext`updatedstr$}, Center], 
            PlotRange -> $CellContext`settings[$CellContext`plotrange], 
            PlotStyle -> ColorData[
              $CellContext`settings[$CellContext`colorscheme]]]}, 
          Background -> $CellContext`settings[$CellContext`background]]], 
      "Specifications" :> {{{$CellContext`x$$, 144, "Months: "}, {162, 156, 
         150, 144, 138, 132, 126, 120, 114, 108, 102, 96, 90, 84, 78, 72, 66, 
         60, 54, 48, 42, 36, 30, 24, 18, 12, 9, 6, 3, 2, 1}}}, 
      "Options" :> {LabelStyle -> {14}, FrameMargins -> None}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{1069.1, {284.1454853108723, 289.8774189046223}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.955203010301695*^9, 3.955203031989119*^9}, {
   3.955203165524811*^9, 3.955203178561948*^9}, {3.955203700020011*^9, 
   3.95520373206479*^9}, {3.955203794918626*^9, 3.955203830826296*^9}, 
   3.955203863937955*^9, 3.9552039442446623`*^9, {3.9552044494503508`*^9, 
   3.95520446248977*^9}, 3.955204545572858*^9, {3.955204619505331*^9, 
   3.955204639980698*^9}, 3.9552046888291483`*^9, 3.9552050808864803`*^9, 
   3.955205204460984*^9, 3.9552056178315496`*^9, 3.955205816327217*^9, 
   3.955205971419527*^9, 3.955206069408033*^9, 3.955206125404375*^9, 
   3.955206996604591*^9, 3.9552070415361843`*^9, 3.955207095893442*^9, 
   3.9552073666541967`*^9, 3.955207408118115*^9, 3.9552074721176567`*^9, {
   3.955207541229095*^9, 3.955207564189248*^9}, {3.9552076224724903`*^9, 
   3.955207651893992*^9}, 3.95520813479666*^9, {3.955208214668593*^9, 
   3.955208226139977*^9}, 3.955208322174212*^9, 3.955282055215171*^9, {
   3.9552822197213573`*^9, 3.9552822633288918`*^9}, 3.9552822957390842`*^9, 
   3.955282367160529*^9, 3.9552829399179707`*^9, {3.955283101832982*^9, 
   3.9552831679180193`*^9}, {3.955283210657043*^9, 3.9552832576556263`*^9}, 
   3.9552900784524393`*^9, {3.9552901521209517`*^9, 3.9552901711323633`*^9}, {
   3.9552902161906643`*^9, 3.955290245925909*^9}, 3.9552903568042707`*^9, 
   3.95529042248026*^9, 3.9552904866077642`*^9, 3.955290569061544*^9, 
   3.955290635024341*^9, {3.955290728516917*^9, 3.955290765666737*^9}},
 CellLabel->"Out[32]=",ExpressionUUID->"d874461f-341d-4a7b-a324-90d57efd32b2"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1435, 1412},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"14.2 for Mac OS X x86 (64-bit) (December 26, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"a56813e7-ec99-4951-a672-b8858fa81f9e"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[576, 22, 743, 11, 96, "Title",ExpressionUUID->"e80cee27-40fb-4de8-aadd-ab763ef324d7"],
Cell[CellGroupData[{
Cell[1344, 37, 4158, 92, 233, "Input",ExpressionUUID->"14006091-21fb-46e0-9a46-e1fcba7cf712",
 CellOpen->True],
Cell[5505, 131, 2206, 34, 42, "Output",ExpressionUUID->"f864cdac-2071-423a-911d-c55c75b2c339"]
}, Open  ]],
Cell[7726, 168, 29751, 547, 3113, "Input",ExpressionUUID->"33df2f7b-054e-4fe7-8633-eec369172053",
 CellOpen->True],
Cell[37480, 717, 1039, 19, 29, "Input",ExpressionUUID->"5611880f-1d46-4cca-99fc-a76f374007cb"],
Cell[CellGroupData[{
Cell[38544, 740, 1766, 32, 213, "Input",ExpressionUUID->"5e768672-063a-4ac3-b17f-cd5d07b7240d"],
Cell[40313, 774, 7175, 132, 591, "Output",ExpressionUUID->"d874461f-341d-4a7b-a324-90d57efd32b2"]
}, Open  ]]
}, Open  ]]
}
]
*)

